<ngx-spinner></ngx-spinner>

<div class="form-row" class="tool">

    <a [style.float]="Rtl? 'right':'left'" routerLink="" class="btn btn-light btn-sm">&nbsp;<span
            class="fas fa-home">&nbsp;&nbsp; </span> {{'Home' | translate }} / </a>
    <span [style.float]="Rtl? 'right':'left'" class="btn btn-light btn-sm"> {{'Reports' | translate }}/</span>
    <a [style.float]="Rtl? 'right':'left'" class="btn btn-light btn-sm">
        <span class="fas fa-sync fa-spin"></span> {{'Customers Reports' | translate }}
    </a>
</div>

<br>

<div class="form-row" *ngIf="!ViewReport">
    <div class="form-group col-md-3">
        <label [style.float]="Rtl? 'right':'left'" for="salesRepId"><span [style.float]="Rtl? 'right':'left'"
                class="badge badge-pill badge-light">
                {{'Sales Representative' | translate}}</span> </label>
        <select #salesRepId="ngModel" class="custom-select custom-select-sm" [(ngModel)]="SalesID" name="salesRepId"
            id="salesRepId" (ngModelChange)="onChangeSelectionCustomerBySalesID($event)">
            <option *ngFor="let xsector of AllSales" value={{xsector.salesRepId}}>
                {{xsector.salesRepName}}

            </option>
        </select>
    </div>

    <div class="form-group col-md-3">
        <label [style.float]="Rtl? 'right':'left'" for="customerId"><span [style.float]="Rtl? 'right':'left'"
                class="badge badge-pill badge-light">
                {{'Customer' | translate}}</span> </label>
        <select #customerId="ngModel" class="custom-select custom-select-sm" [(ngModel)]="CustomerID" name="customerId"
            id="customerId" (ngModelChange)="onChangeSelectionByCustomer($event)">
            <option *ngFor="let xsector of AllCustomers" value={{xsector.customerId}}>
                {{xsector.customerName}}

            </option>
        </select>
    </div>

    <div class="form-group col-md-3">
        <label [style.float]="Rtl? 'right':'left'" for="fromDate"><span [style.float]="Rtl? 'right':'left'"
                class="badge badge-pill badge-light">
                {{'From Date' | translate}}</span> </label>

        <input #fromDate="ngModel" type="date" name="fromDate" [(ngModel)]="FromDate" class="form-control input-sm"
            id="fromDate">
    </div>

    <div class="form-group col-md-3">
        <label [style.float]="Rtl? 'right':'left'" for="toDate"><span [style.float]="Rtl? 'right':'left'"
                class="badge badge-pill badge-light">
                {{'To Date' | translate}}</span> </label>

        <input #toDate="ngModel" type="date" name="toDate" [(ngModel)]="ToDate" class="form-control input-sm"
            id="toDate">
    </div>

</div>

<div class="from-row" style="margin-left: 30%;" *ngIf="!ViewReport">

    <button style="background-color: rgb(red, green, blue) ;" type="button" id="btnoption" class="btn btn-md" (click)="Filter()">
        <i class="fa fa-filter" aria-hidden="true"></i> {{'Filter' | translate }}
    </button>

    &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;

    <button style="background-color: rgb(red, green, blue);" type="button" id="btnoption" class="btn btn-md" (click)="ViewQuestionAnswer()">
        <i class="fa fa-eye" aria-hidden="true"></i> {{'View Customer Report' | translate }}
    </button>

</div>




<hr *ngIf="!ViewReport">

<div class="form-row" *ngIf="!ViewReport">
    <ag-grid-angular #agGrid style="width: 88%; height: 250px;" class="ag-theme-alpine" [rowData]="rowData | async"
        [columnDefs]="columnDefs" [defaultColDef]="defaultColDef" [enableRtl]="Rtl" animateRows
        [rowSelection]="rowSelection" (gridReady)="onGridReady($event)" pagination>
    </ag-grid-angular>
</div>



<ng-container class="form-row" *ngIf="ViewReport">

    <div class="form-row">
        <div class="row">
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="visitNumber"><span [style.float]="Rtl? 'right':'left'"
                        class="badge badge-pill badge-light">
                        {{'Visit Number' | translate}}</span> </label>

                <input #visitNumber="ngModel" type="text" name="visitNumber"
                    [(ngModel)]="CustomerVisitsSerc.IVCustomerVisits.visitNumber" class="form-control input-sm"
                    id="visitNumber" readonly>
            </div>
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="date"><span [style.float]="Rtl? 'right':'left'"
                        class="badge badge-pill badge-light">
                        {{'Date' | translate}}</span> </label>

                <input #date="ngModel" type="text" name="date" [(ngModel)]="CustomerVisitsSerc.IVCustomerVisits.date"
                    class="form-control input-sm" id="date" readonly>
            </div>
        </div>
        <div class="row">
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="customerName"><span [style.float]="Rtl? 'right':'left'"
                        class="badge badge-pill badge-light">
                        {{'Customer' | translate}}</span> </label>

                <input #customerName="ngModel" type="text" name="customerName"
                    [(ngModel)]="CustomerVisitsSerc.IVCustomerVisits.customerName" class="form-control input-sm"
                    id="customerName" readonly>
            </div>
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="salesRepName"><span [style.float]="Rtl? 'right':'left'"
                        class="badge badge-pill badge-light">
                        {{'Sales Representative' | translate}}</span> </label>

                <input #salesRepName="ngModel" type="text" name="salesRepName"
                    [(ngModel)]="CustomerVisitsSerc.IVCustomerVisits.salesRepName" class="form-control input-sm"
                    id="salesRepName" readonly>
            </div>
        </div>
        <div class="row">
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="versionActulCode"><span
                        [style.float]="Rtl? 'right':'left'" class="badge badge-pill badge-light">
                        {{'Version Code' | translate}}</span> </label>

                <input #versionActulCode="ngModel" type="text" name="versionActulCode"
                    [(ngModel)]="VersionServ.Version.versionActulCode" class="form-control input-sm"
                    id="versionActulCode" readonly>
            </div>
            <div class="form-group col-md-6">
                <label [style.float]="Rtl? 'right':'left'" for="versionName"><span [style.float]="Rtl? 'right':'left'"
                        class="badge badge-pill badge-light">
                        {{'Version Name' | translate}}</span> </label>

                <input #versionName="ngModel" type="text" name="versionName"
                    [(ngModel)]="VersionServ.Version.versionName" class="form-control input-sm" id="versionName"
                    readonly>
            </div>



        </div>
    </div>

    <hr>

    <div style="margin-bottom: 10px;" class="form-row">
        <button type="button" id="btnoption" class="btn btn-dark btn-lg">
            {{'Questions' | translate }}
        </button>
    </div>

    <li *ngFor="let content of QuestionsList">
        <label style="font-size: large; font-weight: bold;">{{content.questionName}}</label>
        <div *ngFor="let customer of CustomerVisits">
            <div style="margin-left: 30px;" *ngIf="customer.questionCode==content.questionCode">

                <div style="margin-bottom: 20px;" *ngIf="customer.questionNotes != null">

                    <label [style.float]="Rtl? 'right':'left'" style="font-size: small; font-weight: bold;"
                        for="questionNotes">
                        {{'Question Notes' | translate}}</label>
                    <input #questionNotes="ngModel" type="text" name="questionNotes"
                        [(ngModel)]="customer.questionNotes" class="form-control input-sm" id="questionNotes" readonly>
                </div>

                <div *ngIf="content.attachmentYN">
                    <div *ngFor="let Customerfile of CustomerVisitsFilesList">
                        <div *ngIf="content.questionCode== Customerfile.questionCode">

                            <div *ngIf="Customerfile.filePath != ''" style="margin-bottom: 20px;">

                                <label [style.float]="Rtl? 'right':'left'" style="font-size: small; font-weight: bold;"
                                    for="filePath">
                                    {{'File Path' | translate}}</label>
                                <input #filePath="ngModel" type="text" name="filePath"
                                    [(ngModel)]="Customerfile.filePath" class="form-control input-sm" id="filePath"
                                    readonly>
                                <div style="margin-top: 10px;" class="form-group col-md-6">
                                    <button type="button" class="btn btn-light btn-sm"
                                        (click)="DownloadFile(Customerfile.filePath)">
                                        <span class="fas fa-download">&nbsp;&nbsp;</span>{{'Download File' | translate}}
                                        &nbsp;&nbsp;</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="content.progId>0">
                    <div *ngFor="let agent of Agents">
                        <div *ngIf="customer.progIDAnswer== agent.agentCode">

                            <div style="margin-bottom: 20px;">

                                <label [style.float]="Rtl? 'right':'left'" style="font-size: small; font-weight: bold;"
                                    for="agentName">
                                    {{'Agent' | translate}}</label>
                                <input #agentName="ngModel" type="text" name="agentName" [(ngModel)]="agent.agentName"
                                    class="form-control input-sm" id="agentName" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="customer.answerTypeCode!=null" >
                    <label  [style.float]="Rtl? 'right':'left'" style="font-size: small; font-weight: bold;"
                        for="questionNotes">
                        {{'Question Answer' | translate}}</label>
                    <input *ngIf="customer.answerTypeCode==1" #answerName="ngModel" type="text" name="answerName"
                        [(ngModel)]="customer.answerName" class="form-control input-sm" id="answerName" readonly>

                    <input *ngIf="customer.answerTypeCode==2" #rateNumber="ngModel" type="text" name="rateNumber"
                        [(ngModel)]="customer.rateNumber" class="form-control input-sm" id="rateNumber" readonly>

                    <div *ngIf="customer.answerTypeCode==3">
                        <div *ngFor="let Customerchoises of CustomerVisitAnswerChoisesList">
                            <div *ngFor="let choises of AnswerChoisesList">

                                <input *ngIf="Customerchoises.answerChoiseCode==choises.answerChoiseCode"
                                    #answerChoiseName="ngModel" type="text" name="answerChoiseName"
                                    [(ngModel)]="choises.answerChoiseName" class="form-control input-sm"
                                    id="answerChoiseName" readonly>

                                <div style="margin-bottom: 20px;" *ngIf="Customerchoises.answerChoiseNotes!=null">

                                    <label [style.float]="Rtl? 'right':'left'"
                                        style="font-size: small; font-weight: bold;" for="questionNotes">
                                        {{'Choise Notes' | translate}}</label>
                                    <input #answerChoiseNotes="ngModel" type="text" name="answerChoiseNotes"
                                        [(ngModel)]="Customerchoises.answerChoiseNotes" class="form-control input-sm"
                                        id="answerChoiseNotes" readonly>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>
    </li>


    &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;
    <button style="margin-left: 400px; margin-top: 20px;" type="button" id="btnoption" class="btn btn-success btn-lg"
        (click)="cancel()">
        <i class="fas fa-undo" aria-hidden="true"></i> {{'Back' | translate }}
    </button>


</ng-container>